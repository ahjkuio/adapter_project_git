2025-03-15 10:30:58,316 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 10:30:58,317 [INFO] Свободная память: 39.50 ГБ
2025-03-15 10:30:58,317 [INFO] Загрузка данных Nerus...
2025-03-15 10:30:58,911 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 10:30:58,992 [INFO] 
Работа скрипта завершена!
2025-03-15 10:31:29,298 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 10:31:29,298 [INFO] Свободная память: 39.50 ГБ
2025-03-15 10:31:29,298 [INFO] Загрузка данных Nerus...
2025-03-15 10:31:29,556 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 10:31:29,636 [INFO] Загружаем базовую модель для оценки...
2025-03-15 10:31:29,636 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 10:31:30,323 [INFO] Based on the current allocation process, no modules could be assigned to the following devices due to insufficient memory:
  - 0: 1313341440.0 bytes required
These minimum requirements are specific to this allocation attempt and may vary. Consider increasing the available memory for these devices to at least the specified minimum, or adjusting the model config.
2025-03-15 10:31:36,310 [INFO] Модель и токенизатор успешно загружены
2025-03-15 10:31:36,311 [INFO] Оцениваем базовую модель на датасете TERRa...
2025-03-15 10:33:43,374 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 10:33:43,375 [INFO] Свободная память: 39.50 ГБ
2025-03-15 10:33:43,375 [INFO] Загрузка данных Nerus...
2025-03-15 10:33:43,632 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 10:33:43,713 [INFO] Загружаем базовую модель для оценки...
2025-03-15 10:33:43,713 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 10:33:44,466 [INFO] Based on the current allocation process, no modules could be assigned to the following devices due to insufficient memory:
  - 0: 1313341440.0 bytes required
These minimum requirements are specific to this allocation attempt and may vary. Consider increasing the available memory for these devices to at least the specified minimum, or adjusting the model config.
2025-03-15 10:33:50,681 [INFO] Модель и токенизатор успешно загружены
2025-03-15 10:33:50,681 [INFO] Оцениваем базовую модель на датасете TERRa...
2025-03-15 10:33:50,948 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 10:37:48,568 [INFO] Оцениваем базовую модель на датасете Nerus...
2025-03-15 10:37:48,568 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 10:41:34,262 [INFO] 
Работа скрипта завершена!
2025-03-15 10:45:05,464 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 10:45:05,464 [INFO] Свободная память: 39.50 ГБ
2025-03-15 10:45:05,464 [INFO] Загрузка данных Nerus...
2025-03-15 10:45:05,708 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 10:45:05,787 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 10:45:06,575 [INFO] Based on the current allocation process, no modules could be assigned to the following devices due to insufficient memory:
  - 0: 1313341440.0 bytes required
These minimum requirements are specific to this allocation attempt and may vary. Consider increasing the available memory for these devices to at least the specified minimum, or adjusting the model config.
2025-03-15 10:45:12,667 [INFO] Модель и токенизатор успешно загружены
2025-03-15 10:45:12,667 [INFO] Подготавливаем данные для обучения...
2025-03-15 10:45:15,500 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 10:45:15,663 [INFO] Настраиваем параметры обучения...
2025-03-15 10:45:15,771 [INFO] Начинаем обучение...
2025-03-15 11:43:04,842 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 11:43:04,843 [INFO] Свободная память: 39.50 ГБ
2025-03-15 11:43:04,843 [INFO] Загрузка данных Nerus...
2025-03-15 11:43:05,095 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 11:43:05,172 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 11:43:37,231 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 11:43:37,231 [INFO] Свободная память: 39.50 ГБ
2025-03-15 11:43:37,231 [INFO] Загрузка данных Nerus...
2025-03-15 11:43:37,510 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 11:43:37,590 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 11:43:38,251 [INFO] Based on the current allocation process, no modules could be assigned to the following devices due to insufficient memory:
  - 0: 1313341440.0 bytes required
These minimum requirements are specific to this allocation attempt and may vary. Consider increasing the available memory for these devices to at least the specified minimum, or adjusting the model config.
2025-03-15 11:43:44,554 [INFO] Модель и токенизатор успешно загружены
2025-03-15 11:43:44,556 [INFO] Подготавливаем данные для обучения...
2025-03-15 11:43:47,533 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 11:43:47,694 [INFO] Настраиваем параметры обучения...
2025-03-15 11:43:47,790 [INFO] Начинаем обучение...
2025-03-15 11:47:22,463 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 11:47:22,465 [INFO] Свободная память: 39.50 ГБ
2025-03-15 11:47:22,465 [INFO] Загрузка данных Nerus...
2025-03-15 11:47:22,747 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 11:47:22,824 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 11:47:24,634 [INFO] Based on the current allocation process, no modules could be assigned to the following devices due to insufficient memory:
  - 0: 1313341440.0 bytes required
These minimum requirements are specific to this allocation attempt and may vary. Consider increasing the available memory for these devices to at least the specified minimum, or adjusting the model config.
2025-03-15 11:47:31,256 [INFO] Модель и токенизатор успешно загружены
2025-03-15 11:47:31,256 [INFO] Подготавливаем данные для обучения...
2025-03-15 11:47:34,194 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 11:47:34,366 [INFO] Настраиваем параметры обучения...
2025-03-15 11:47:34,465 [INFO] Начинаем обучение...
2025-03-15 11:50:05,036 [INFO] Выбрана GPU 0: NVIDIA A100-PCIE-40GB
2025-03-15 11:50:05,036 [INFO] Свободная память: 39.50 ГБ
2025-03-15 11:50:05,036 [INFO] Загрузка данных Nerus...
2025-03-15 11:50:05,309 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 11:50:05,395 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 11:50:11,906 [INFO] Модель и токенизатор успешно загружены
2025-03-15 11:50:11,906 [INFO] Подготавливаем данные для обучения...
2025-03-15 11:50:14,930 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 11:50:15,088 [INFO] Настраиваем параметры обучения...
2025-03-15 11:50:15,197 [INFO] Начинаем обучение...
2025-03-15 11:52:56,423 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 11:52:56,423 [INFO] Загрузка данных Nerus...
2025-03-15 11:52:56,692 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 11:52:56,775 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 11:53:03,051 [INFO] Модель и токенизатор успешно загружены
2025-03-15 11:53:03,051 [INFO] Подготавливаем данные для обучения...
2025-03-15 11:53:06,019 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 11:53:06,166 [INFO] Настраиваем параметры обучения...
2025-03-15 11:53:06,278 [INFO] Начинаем обучение...
2025-03-15 12:34:17,604 [INFO] Сохраняем обученную модель...
2025-03-15 12:34:18,215 [INFO] Оцениваем модель на валидационном наборе...
2025-03-15 12:35:02,722 [INFO] Оцениваем модель с LoRA на датасете TERRa...
2025-03-15 12:35:02,961 [INFO] Включаем адаптер default...
2025-03-15 12:35:02,967 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 12:37:38,893 [INFO] Оцениваем модель с LoRA на датасете Nerus...
2025-03-15 12:37:38,893 [INFO] Включаем адаптер default...
2025-03-15 12:37:38,899 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 12:40:07,143 [INFO] 
Работа скрипта завершена!
2025-03-15 12:42:48,162 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 12:42:48,163 [INFO] Загрузка данных Nerus...
2025-03-15 12:42:48,451 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 12:42:48,533 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 12:42:54,894 [INFO] Модель и токенизатор успешно загружены
2025-03-15 12:42:54,894 [INFO] Подготавливаем данные для обучения...
2025-03-15 12:42:57,793 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 12:42:57,912 [INFO] Настраиваем параметры обучения...
2025-03-15 12:42:58,012 [INFO] Начинаем обучение...
2025-03-15 12:54:36,996 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 12:54:36,996 [INFO] Загрузка данных Nerus...
2025-03-15 12:54:37,446 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 12:54:37,525 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 12:54:44,329 [INFO] Модель и токенизатор успешно загружены
2025-03-15 12:54:44,330 [INFO] Подготавливаем данные для обучения...
2025-03-15 12:54:46,566 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 12:54:46,688 [INFO] Настраиваем параметры обучения...
2025-03-15 12:54:46,812 [INFO] Начинаем обучение...
2025-03-15 13:01:11,953 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 13:01:11,953 [INFO] Загрузка данных Nerus...
2025-03-15 13:01:12,257 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 13:01:12,338 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 13:01:19,951 [INFO] Модель и токенизатор успешно загружены
2025-03-15 13:01:19,951 [INFO] Подготавливаем данные для обучения...
2025-03-15 13:01:26,989 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 13:01:27,052 [INFO] Настраиваем параметры обучения...
2025-03-15 13:01:27,178 [INFO] Начинаем обучение...
2025-03-15 14:10:35,066 [INFO] Сохраняем обученную модель...
2025-03-15 14:10:35,898 [INFO] Оцениваем модель на валидационном наборе...
2025-03-15 14:11:39,427 [INFO] Оцениваем модель с LoRA на датасете TERRa...
2025-03-15 14:11:45,712 [INFO] Включаем адаптер default...
2025-03-15 14:11:45,720 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 14:15:22,753 [INFO] Оцениваем модель с LoRA на датасете Nerus...
2025-03-15 14:15:22,753 [INFO] Включаем адаптер default...
2025-03-15 14:15:22,756 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 14:18:46,467 [INFO] 
Работа скрипта завершена!
2025-03-15 20:12:58,153 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 20:12:58,153 [INFO] Загрузка данных Nerus...
2025-03-15 20:12:58,428 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 20:12:58,503 [INFO] Загружаем предварительно обученную модель с LoRA из /home/ahjkuio/adapter_project/models/lora/r4_alpha8...
2025-03-15 20:12:58,503 [INFO] Загружаем базовую модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 20:12:59,185 [INFO] We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-03-15 20:13:04,777 [INFO] Загружаем LoRA адаптеры из /home/ahjkuio/adapter_project/models/lora/r4_alpha8...
2025-03-15 20:13:04,876 [INFO] Модель с LoRA адаптерами успешно загружена
2025-03-15 20:13:04,876 [INFO] Оцениваем модель с LoRA на датасете TERRa...
2025-03-15 20:13:05,103 [INFO] Включаем адаптер default...
2025-03-15 20:13:05,107 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 20:15:55,564 [INFO] Оцениваем модель с LoRA на датасете Nerus...
2025-03-15 20:15:55,565 [INFO] Включаем адаптер default...
2025-03-15 20:15:55,568 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 20:18:44,319 [INFO] 
--- Тестирование модели на примерах ---
2025-03-15 20:18:44,319 [INFO] 
Модель с LoRA:
2025-03-15 20:18:44,320 [INFO] 
Пример 1: Президент России Владимир Путин провел совещание в Москве с представителями Газпрома.
2025-03-15 20:18:44,320 [INFO] Включаем адаптер default...
2025-03-15 20:18:53,466 [INFO] Ответ сгенерирован за 9.14 сек, 100 токенов
2025-03-15 20:18:53,467 [INFO] Ответ модели с LoRA:  [России](LOC), [Владимиров](PER), [Путина](PER), [Газпроме](ORG), [Москве](LOC)://Москва](LOC))(IDC</a></p> = [Русской федерации](LOC)</em>)</span><span class="bge">[Калужской области](LOC)[ Арендованного имущества ](_LOC</a>ndon
2025-03-15 20:18:53,467 [INFO] Время: 9.14 сек, Токенов: 100
2025-03-15 20:18:53,467 [INFO] 
Пример 2: В Санкт-Петербурге на фестивале выступили музыканты из группы Аквариум.
2025-03-15 20:18:53,467 [INFO] Включаем адаптер default...
2025-03-15 20:18:58,517 [INFO] Ответ сгенерирован за 5.05 сек, 55 токенов
2025-03-15 20:18:58,517 [INFO] Ответ модели с LoRA:  [Санкт-Петерббурге](LOC), [Аквориум](ORG)_REF] = [Петербурге](_LOC), [Каравана-Головачева](PER), [Михалкина](PER)
2025-03-15 20:18:58,517 [INFO] Время: 5.05 сек, Токенов: 55
2025-03-15 20:18:58,517 [INFO] 
Пример 3: Глава МИД Сергей Лавров встретился со своим французским коллегой Жаном-Ивом Ле Дрианом.
2025-03-15 20:18:58,517 [INFO] Включаем адаптер default...
2025-03-15 20:19:03,043 [INFO] Ответ сгенерирован за 4.52 сек, 49 токенов
2025-03-15 20:19:03,043 [INFO] Ответ модели с LoRA:  [Сергей Л.avrov](PER), [МИД](ORG), [Францией](LOC), [Жаном- Ивом ](PER), [. Ле Дрииным](PER)php endif?
2025-03-15 20:19:03,043 [INFO] Время: 4.52 сек, Токенов: 49
2025-03-15 20:19:03,043 [INFO] 
Работа скрипта завершена!
2025-03-15 20:35:01,490 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 20:35:01,490 [INFO] Загрузка данных Nerus...
2025-03-15 20:35:01,847 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 20:35:01,923 [INFO] Загружаем базовую модель для оценки...
2025-03-15 20:35:01,923 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 20:35:08,574 [INFO] Модель и токенизатор успешно загружены
2025-03-15 20:35:08,574 [INFO] Оцениваем базовую модель на датасете TERRa...
2025-03-15 20:35:08,803 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 20:38:22,586 [INFO] Оцениваем базовую модель на датасете Nerus...
2025-03-15 20:38:22,586 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 20:41:28,269 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 20:42:21,268 [INFO] Модель и токенизатор успешно загружены
2025-03-15 20:42:21,311 [INFO] Подготавливаем данные для обучения...
2025-03-15 20:42:28,671 [INFO] Применяем LoRA адаптеры к модели...
2025-03-15 20:42:29,105 [INFO] Настраиваем параметры обучения...
2025-03-15 20:42:29,247 [INFO] Начинаем обучение...
2025-03-15 21:52:48,981 [INFO] Сохраняем обученную модель...
2025-03-15 21:52:49,782 [INFO] Оцениваем модель на валидационном наборе...
2025-03-15 21:53:58,619 [INFO] Оцениваем модель с LoRA на датасете TERRa...
2025-03-15 21:53:58,619 [INFO] Включаем адаптер default...
2025-03-15 21:53:58,624 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 21:57:55,265 [INFO] Оцениваем модель с LoRA на датасете Nerus...
2025-03-15 21:57:55,265 [INFO] Включаем адаптер default...
2025-03-15 21:57:55,270 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 22:01:41,002 [INFO] Сравнение результатов базовой модели и модели с LoRA:
2025-03-15 22:01:41,002 [INFO] 
Датасет TERRA:
2025-03-15 22:01:41,002 [INFO] accuracy: 0.4800 -> 0.7200 [Изменение: 0.2400 (+50.00%)]
2025-03-15 22:01:41,002 [INFO] precision: 0.5000 -> 0.5000 [Изменение: 0.0000 (+0.00%)]
2025-03-15 22:01:41,002 [INFO] recall: 0.2400 -> 0.3600 [Изменение: 0.1200 (+50.00%)]
2025-03-15 22:01:41,002 [INFO] f1: 0.3243 -> 0.4186 [Изменение: 0.0943 (+29.07%)]
2025-03-15 22:01:41,002 [INFO] 
Датасет NERUS:

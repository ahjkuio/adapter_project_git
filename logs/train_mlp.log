2025-03-15 16:21:22,288 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:21:22,289 [INFO] 
--- Оценка базовой модели ---
2025-03-15 16:21:22,289 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:22:06,009 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:22:06,240 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 16:24:29,008 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 16:26:49,769 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:26:49,769 [INFO] Загрузка данных Nerus...
2025-03-15 16:26:49,923 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:26:49,990 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:26:57,061 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:26:57,082 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:26:57,126 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:26:57,128 [INFO] Всего параметров: 4544811520
2025-03-15 16:26:57,128 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:26:57,128 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:27:04,282 [INFO] Настраиваем параметры обучения...
2025-03-15 16:27:04,481 [INFO] Начинаем обучение...
2025-03-15 16:30:17,864 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:30:17,865 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:30:17,865 [INFO] Загрузка данных Nerus...
2025-03-15 16:30:17,913 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:30:17,993 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:30:24,760 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:30:24,760 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:30:24,802 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:30:24,803 [INFO] Всего параметров: 4544811520
2025-03-15 16:30:24,803 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:30:24,804 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:30:31,904 [INFO] Настраиваем параметры обучения...
2025-03-15 16:30:32,002 [INFO] Начинаем обучение...
2025-03-15 16:32:57,422 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:32:57,422 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:32:57,422 [INFO] Загрузка данных Nerus...
2025-03-15 16:32:57,472 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:32:57,551 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:33:04,136 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:33:04,136 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:33:04,178 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:33:04,180 [INFO] Всего параметров: 4544811520
2025-03-15 16:33:04,180 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:33:04,180 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:33:11,300 [INFO] Настраиваем параметры обучения...
2025-03-15 16:33:11,384 [INFO] Начинаем обучение...
2025-03-15 16:35:12,932 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:35:12,932 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:35:12,932 [INFO] Загрузка данных Nerus...
2025-03-15 16:35:12,979 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:35:13,059 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:35:19,444 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:35:19,444 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:35:19,486 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:35:19,487 [INFO] Всего параметров: 4544811520
2025-03-15 16:35:19,487 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:35:19,487 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:35:26,574 [INFO] Настраиваем параметры обучения...
2025-03-15 16:35:26,671 [INFO] Начинаем обучение...
2025-03-15 16:38:49,690 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:38:49,690 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:38:49,690 [INFO] Загрузка данных Nerus...
2025-03-15 16:38:49,737 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:38:49,813 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:38:56,615 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:38:56,615 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:38:56,657 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:38:56,659 [INFO] Всего параметров: 4544811520
2025-03-15 16:38:56,659 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:38:56,659 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:39:03,662 [INFO] Настраиваем параметры обучения...
2025-03-15 16:39:03,752 [INFO] Начинаем обучение...
2025-03-15 16:48:48,348 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 16:48:48,349 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 16:48:48,349 [INFO] Загрузка данных Nerus...
2025-03-15 16:48:48,397 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 16:48:48,472 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 16:48:55,251 [INFO] Модель и токенизатор успешно загружены
2025-03-15 16:48:55,251 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 16:48:55,293 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 16:48:55,296 [INFO] Всего параметров: 4544811520
2025-03-15 16:48:55,296 [INFO] Обучаемых параметров: 4211200
2025-03-15 16:48:55,296 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 16:49:02,365 [INFO] Настраиваем параметры обучения...
2025-03-15 16:49:02,459 [INFO] Начинаем обучение...
2025-03-15 17:18:37,965 [INFO] Сохраняем обученные MLP-адаптеры...
2025-03-15 17:18:38,034 [INFO] MLP-адаптеры сохранены в /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:18:38,035 [INFO] Оцениваем модель на валидационном наборе...
2025-03-15 17:19:16,548 [INFO] 
--- Оценка модели с MLP-адаптерами ---
2025-03-15 17:19:16,799 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 17:25:26,129 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 17:25:26,129 [INFO] 
--- Оценка модели с MLP-адаптерами ---
2025-03-15 17:25:26,129 [INFO] Загружаем модель с MLP-адаптерами...
2025-03-15 17:25:26,129 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 17:25:32,672 [INFO] Модель и токенизатор успешно загружены
2025-03-15 17:25:32,713 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 17:25:32,740 [INFO] MLP-адаптеры загружены из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:25:32,742 [INFO] Модель с MLP-адаптерами успешно загружена из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:25:32,978 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 17:29:38,884 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 17:29:38,884 [INFO] 
--- Оценка модели с MLP-адаптерами ---
2025-03-15 17:29:38,884 [INFO] Загружаем модель с MLP-адаптерами...
2025-03-15 17:29:38,884 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 17:29:45,305 [INFO] Модель и токенизатор успешно загружены
2025-03-15 17:29:45,346 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 17:29:45,354 [INFO] Загружаем адаптеры на устройство: cuda:0
2025-03-15 17:29:45,364 [INFO] MLP-адаптеры загружены из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:29:45,365 [INFO] Модель с MLP-адаптерами успешно загружена из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:29:45,594 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 17:36:53,902 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 17:36:53,902 [INFO] 
--- Оценка модели с MLP-адаптерами ---
2025-03-15 17:36:53,902 [INFO] Загружаем модель с MLP-адаптерами...
2025-03-15 17:36:53,902 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 17:37:00,518 [INFO] Модель и токенизатор успешно загружены
2025-03-15 17:37:00,519 [INFO] Базовая модель использует dtype: torch.bfloat16, устройство: cuda:0
2025-03-15 17:37:00,559 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 17:37:00,603 [INFO] Загружаем адаптеры на устройство: cuda:0, тип данных: torch.bfloat16
2025-03-15 17:37:00,604 [INFO] Загружаем адаптеры в старом формате (.bin)
2025-03-15 17:37:00,614 [INFO] MLP-адаптеры загружены из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:37:00,616 [INFO] Модель с MLP-адаптерами успешно загружена из /home/ahjkuio/adapter_project/models/mlp
2025-03-15 17:37:00,848 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 17:39:23,509 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 17:41:46,085 [INFO] 
--- Тестирование модели на примерах ---
2025-03-15 17:41:46,085 [INFO] 
Модель с MLP-адаптерами:
2025-03-15 17:41:46,085 [INFO] 
Пример 1: Президент России Владимир Путин провел совещание в Москве с представителями Газпрома.
2025-03-15 17:41:46,085 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 17:41:53,867 [INFO] Сгенерирован ответ: Президент России = Владимира Путина (PER), Москва = Моску (LOC), Газпрому = Газприму (ORG)://Газприу...
2025-03-15 17:41:53,868 [INFO] Время генерации: 7.78 сек
2025-03-15 17:41:53,868 [INFO] Сгенерировано токенов: 100
2025-03-15 17:41:53,868 [INFO] Ответ модели с MLP-адаптерами: Президент России = Владимира Путина (PER), Москва = Моску (LOC), Газпрому = Газприму (ORG)://Газприум (ORG)
Связанные документы
[Николай Макаров](Москву) назначен заместителем руководителя «Ростехнологии».
В конце 2018 года правительство утвердило концепцию развития угольной от
2025-03-15 17:41:53,868 [INFO] Время: 7.78 сек, Токенов: 100
2025-03-15 17:41:53,868 [INFO] 
Пример 2: В Санкт-Петербурге на фестивале выступили музыканты из группы Аквариум.
2025-03-15 17:41:53,868 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 17:41:56,583 [INFO] Сгенерирован ответ: Аквориум (ORG)://
Санкт-Петербурга (LOC)
Категория ответа: PER, LOC, ORГ....
2025-03-15 17:41:56,583 [INFO] Время генерации: 2.72 сек
2025-03-15 17:41:56,583 [INFO] Сгенерировано токенов: 35
2025-03-15 17:41:56,583 [INFO] Ответ модели с MLP-адаптерами: Аквориум (ORG)://
Санкт-Петербурга (LOC)
Категория ответа: PER, LOC, ORГ.
2025-03-15 17:41:56,584 [INFO] Время: 2.72 сек, Токенов: 35
2025-03-15 17:41:56,584 [INFO] 
Пример 3: Глава МИД Сергей Лавров встретился со своим французским коллегой Жаном-Ивом Ле Дрианом.
2025-03-15 17:41:56,584 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 17:42:04,413 [INFO] Сгенерирован ответ: Глава М И Д Сергей ЛьвовLOC ФранцузскийОРГ М И DПерсона Жан-Иву Ле ДрииаnРаботодатель Ле Дрьяна
Серг...
2025-03-15 17:42:04,414 [INFO] Время генерации: 7.83 сек
2025-03-15 17:42:04,414 [INFO] Сгенерировано токенов: 100
2025-03-15 17:42:04,414 [INFO] Ответ модели с MLP-адаптерами: Глава М И Д Сергей ЛьвовLOC ФранцузскийОРГ М И DПерсона Жан-Иву Ле ДрииаnРаботодатель Ле Дрьяна
Сергей ЛьвovРаФранцииЛьвов – это фамилия. Он является частью имени главы министерства иностранных дел России. В этом случае мы можем сделать вывод о том, что Сергей Lvов работает на правитель
2025-03-15 17:42:04,414 [INFO] Время: 7.83 сек, Токенов: 100
2025-03-15 17:42:04,414 [INFO] 
Работа скрипта завершена!
2025-03-15 19:01:40,950 [INFO] Доступна только одна GPU: NVIDIA A100-PCIE-40GB
2025-03-15 19:01:40,950 [INFO] 
--- Обучение модели с MLP-адаптерами ---
2025-03-15 19:01:40,950 [INFO] Загрузка данных Nerus...
2025-03-15 19:01:40,999 [INFO] Загружено 4500 тренировочных и 500 валидационных примеров
2025-03-15 19:01:41,075 [INFO] Загружаем модель unsloth/Meta-Llama-3.1-8B-Instruct...
2025-03-15 19:01:47,510 [INFO] Модель и токенизатор успешно загружены
2025-03-15 19:01:47,511 [INFO] Создаем модель с MLP-адаптерами...
2025-03-15 19:01:47,511 [INFO] Базовая модель использует dtype: torch.bfloat16, устройство: cuda:0
2025-03-15 19:01:47,552 [INFO] Всего обучаемых параметров в адаптерах: 4211200
2025-03-15 19:01:47,605 [INFO] Всего параметров: 4544811520
2025-03-15 19:01:47,605 [INFO] Обучаемых параметров: 4211200
2025-03-15 19:01:47,606 [INFO] Процент обучаемых параметров: 0.0927%
2025-03-15 19:01:54,653 [INFO] Настраиваем параметры обучения...
2025-03-15 19:01:54,741 [INFO] Начинаем обучение...
2025-03-15 19:32:11,456 [INFO] Сохраняем обученные MLP-адаптеры...
2025-03-15 19:32:11,473 [INFO] MLP-адаптеры сохранены в /home/ahjkuio/adapter_project/models/mlp
2025-03-15 19:32:11,473 [INFO] Оцениваем модель на валидационном наборе...
2025-03-15 19:32:49,899 [INFO] 
--- Оценка модели с MLP-адаптерами ---
2025-03-15 19:32:50,155 [INFO] Оцениваем модель на датасете TERRa...
2025-03-15 19:35:11,021 [INFO] Оцениваем модель на датасете Nerus...
2025-03-15 19:37:31,824 [INFO] Сохраняем метрики модели с MLP-адаптерами...
2025-03-15 19:37:31,825 [INFO] 
--- Тестирование модели на примерах ---
2025-03-15 19:37:31,825 [INFO] 
Модель с MLP-адаптерами:
2025-03-15 19:37:31,825 [INFO] 
Пример 1: Президент России Владимир Путин провел совещание в Москве с представителями Газпрома.
2025-03-15 19:37:31,825 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 19:37:39,396 [INFO] Сгенерирован ответ: Владимиров Путину (PER), Москва (LOC), Газпрому (ORG)://андрей_власенко
</andr> ья = <andr></andr><a...
2025-03-15 19:37:39,396 [INFO] Время генерации: 7.57 сек
2025-03-15 19:37:39,396 [INFO] Сгенерировано токенов: 100
2025-03-15 19:37:39,396 [INFO] Ответ модели с MLP-адаптерами: Владимиров Путину (PER), Москва (LOC), Газпрому (ORG)://андрей_власенко
</andr> ья = <andr></andr><anatoliy = <anatolий></anatолий>
Россияне неоднократно выражали недовольство из-за высоких цен на газ. Основным покупателем российского газа является Украина – ее объемы контракта
2025-03-15 19:37:39,396 [INFO] Время: 7.57 сек, Токенов: 100
2025-03-15 19:37:39,396 [INFO] 
Пример 2: В Санкт-Петербурге на фестивале выступили музыканты из группы Аквариум.
2025-03-15 19:37:39,396 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 19:37:47,269 [INFO] Сгенерирован ответ: Аквориум (ORG)://
Санкт-Петербурга (LOC)
Категория ответа: PER, LOC, ORGANайти инструкцию[/инструкци...
2025-03-15 19:37:47,269 [INFO] Время генерации: 7.87 сек
2025-03-15 19:37:47,269 [INFO] Сгенерировано токенов: 100
2025-03-15 19:37:47,269 [INFO] Ответ модели с MLP-адаптерами: Аквориум (ORG)://
Санкт-Петербурга (LOC)
Категория ответа: PER, LOC, ORGANайти инструкцию[/инструкция]В 2015 году представительница Китая призналась, что страна неоднократно подозревала Россию в пиратстве. "Наши сотрудники обнаруживают подобные случаи ежедневно", — заявила тогда замглав
2025-03-15 19:37:47,270 [INFO] Время: 7.87 сек, Токенов: 100
2025-03-15 19:37:47,270 [INFO] 
Пример 3: Глава МИД Сергей Лавров встретился со своим французским коллегой Жаном-Ивом Ле Дрианом.
2025-03-15 19:37:47,270 [INFO] Генерируем ответ на запрос: Найди и классифицируй все именованные сущности в тексте, указав их тип (PER - персона, LOC - локация...
2025-03-15 19:37:55,122 [INFO] Сгенерирован ответ: Глава МІД = PER
Сергей Ла́воров = PER\nЖан-И́в Ле́ Дриа́н = PER\Французский =LOC
МИД = ORG
Франции =...
2025-03-15 19:37:55,123 [INFO] Время генерации: 7.85 сек
2025-03-15 19:37:55,123 [INFO] Сгенерировано токенов: 100
2025-03-15 19:37:55,123 [INFO] Ответ модели с MLP-адаптерами: Глава МІД = PER
Сергей Ла́воров = PER\nЖан-И́в Ле́ Дриа́н = PER\Французский =LOC
МИД = ORG
Франции = LOC
ЛЕ ДРИАН = Персона. \nЛАВРОВ = PERSONA.
ОРГАНИЗАЦИЯ = ORGANIZATION. \нЛОКАЛЬНОСТЬ = LOCATION
2025-03-15 19:37:55,123 [INFO] Время: 7.85 сек, Токенов: 100
2025-03-15 19:37:55,123 [INFO] 
Работа скрипта завершена!
